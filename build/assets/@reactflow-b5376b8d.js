import{r as h,a as S}from"./react-bc4662ae.js";import"./d3-transition-59b52f5f.js";import{z as Vo,i as Fe}from"./d3-zoom-2ebfab71.js";import{c as ce}from"./classcat-fbd937ed.js";import{u as Oo,c as Fo,s as se}from"./zustand-d79069ef.js";import"./react-dom-e043f906.js";import{s as pn,p as Yo}from"./d3-selection-a6bf8644.js";import{d as Xo}from"./d3-drag-bcb163b8.js";const dt=h.createContext(null),Zo=dt.Provider,he={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},hn=he.error001();function G(e,t){const n=h.useContext(dt);if(n===null)throw new Error(hn);return Oo(n,e,t)}const ne=()=>{const e=h.useContext(dt);if(e===null)throw new Error(hn);return h.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Wo=e=>e.userSelectionActive?"none":"all";function yn({position:e,children:t,className:n,style:o,...s}){const i=G(Wo),r=`${e}`.split("-");return S.createElement("div",{className:ce(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function Ko({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:S.createElement(yn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},S.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Uo=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:u,...a})=>{const d=h.useRef(null),[m,g]=h.useState({x:0,y:0,width:0,height:0}),w=ce(["react-flow__edge-textwrapper",u]);return h.useEffect(()=>{if(d.current){const f=d.current.getBBox();g({x:f.x,y:f.y,width:f.width,height:f.height})}},[n]),typeof n>"u"||!n?null:S.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:w,visibility:m.width?"visible":"hidden",...a},s&&S.createElement("rect",{width:m.width+2*r[0],x:-r[0],y:-r[1],height:m.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),S.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:d,style:o},n),l)};var Go=h.memo(Uo);const $t=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ze=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),kt=(e={x:0,y:0},t)=>({x:Ze(e.x,t[0][0],t[1][0]),y:Ze(e.y,t[0][1],t[1][1])}),Zt=(e,t,n)=>e<t?Ze(Math.abs(e-t),1,50)/50:e>n?-Ze(Math.abs(e-n),1,50)/50:0,xn=(e,t)=>{const n=Zt(e.x,35,t.width-35)*20,o=Zt(e.y,35,t.height-35)*20;return[n,o]},Sn=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},jo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Dt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),qo=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Wt=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),wt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Qo=e=>le(e.width)&&le(e.height)&&le(e.x)&&le(e.y),le=e=>!isNaN(e)&&isFinite(e),q=Symbol.for("internals"),En=["Enter"," ","Escape"],Jo=(e,t)=>{},es=e=>"nativeEvent"in e;function bt(e){var s,i;const t=es(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const wn=e=>"clientX"in e,be=(e,t)=>{var i,r;const n=wn(e),o=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(r=e.touches)==null?void 0:r[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},ct=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},nt=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:m,interactionWidth:g=20})=>S.createElement(S.Fragment,null,S.createElement("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:m}),g&&S.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),s&&le(n)&&le(o)?S.createElement(Go,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u}):null);nt.displayName="BaseEdge";function je(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function bn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Nn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),d=Math.abs(u-t);return[l,u,a,d]}var Re;(function(e){e.Strict="strict",e.Loose="loose"})(Re||(Re={}));var _e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(_e||(_e={}));var et;(function(e){e.Partial="partial",e.Full="full"})(et||(et={}));var we;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(we||(we={}));var at;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(at||(at={}));var z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(z||(z={}));function Kt({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===z.Left||e===z.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Cn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top}){const[r,c]=Kt({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=Kt({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,d,m,g]=Nn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${r},${c} ${l},${u} ${o},${s}`,a,d,m,g]}const _t=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:m,markerEnd:g,markerStart:w,interactionWidth:f})=>{const[p,y,x]=Cn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return S.createElement(nt,{path:p,labelX:y,labelY:x,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:m,markerEnd:g,markerStart:w,interactionWidth:f})});_t.displayName="SimpleBezierEdge";const Ut={[z.Left]:{x:-1,y:0},[z.Right]:{x:1,y:0},[z.Top]:{x:0,y:-1},[z.Bottom]:{x:0,y:1}},ts=({source:e,sourcePosition:t=z.Bottom,target:n})=>t===z.Left||t===z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Gt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ns({source:e,sourcePosition:t=z.Bottom,target:n,targetPosition:o=z.Top,center:s,offset:i}){const r=Ut[t],c=Ut[o],l={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},a=ts({source:l,sourcePosition:t,target:u}),d=a.x!==0?"x":"y",m=a[d];let g=[],w,f;const p={x:0,y:0},y={x:0,y:0},[x,N,C,D]=bn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*c[d]===-1){w=s.x||x,f=s.y||N;const $=[{x:w,y:l.y},{x:w,y:u.y}],M=[{x:l.x,y:f},{x:u.x,y:f}];r[d]===m?g=d==="x"?$:M:g=d==="x"?M:$}else{const $=[{x:l.x,y:u.y}],M=[{x:u.x,y:l.y}];if(d==="x"?g=r.x===m?M:$:g=r.y===m?$:M,t===o){const E=Math.abs(e[d]-n[d]);if(E<=i){const P=Math.min(i-1,i-E);r[d]===m?p[d]=(l[d]>e[d]?-1:1)*P:y[d]=(u[d]>n[d]?-1:1)*P}}if(t!==o){const E=d==="x"?"y":"x",P=r[d]===c[E],k=l[E]>u[E],L=l[E]<u[E];(r[d]===1&&(!P&&k||P&&L)||r[d]!==1&&(!P&&L||P&&k))&&(g=d==="x"?$:M)}const A={x:l.x+p.x,y:l.y+p.y},B={x:u.x+y.x,y:u.y+y.y},_=Math.max(Math.abs(A.x-g[0].x),Math.abs(B.x-g[0].x)),R=Math.max(Math.abs(A.y-g[0].y),Math.abs(B.y-g[0].y));_>=R?(w=(A.x+B.x)/2,f=g[0].y):(w=g[0].x,f=(A.y+B.y)/2)}return[[e,{x:l.x+p.x,y:l.y+p.y},...g,{x:u.x+y.x,y:u.y+y.y},n],w,f,C,D]}function os(e,t,n,o){const s=Math.min(Gt(e,t)/2,Gt(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function Nt({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,borderRadius:r=5,centerX:c,centerY:l,offset:u=20}){const[a,d,m,g,w]=ns({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:u});return[a.reduce((p,y,x)=>{let N="";return x>0&&x<a.length-1?N=os(a[x-1],y,a[x+1],r):N=`${x===0?"M":"L"}${y.x} ${y.y}`,p+=N,p},""),d,m,g,w]}const ft=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,sourcePosition:d=z.Bottom,targetPosition:m=z.Top,markerEnd:g,markerStart:w,pathOptions:f,interactionWidth:p})=>{const[y,x,N]=Nt({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:m,borderRadius:f==null?void 0:f.borderRadius,offset:f==null?void 0:f.offset});return S.createElement(nt,{path:y,labelX:x,labelY:N,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:g,markerStart:w,interactionWidth:p})});ft.displayName="SmoothStepEdge";const Rt=h.memo(e=>{var t;return S.createElement(ft,{...e,pathOptions:h.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Rt.displayName="StepEdge";function ss({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=bn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Tt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:m,interactionWidth:g})=>{const[w,f,p]=ss({sourceX:e,sourceY:t,targetX:n,targetY:o});return S.createElement(nt,{path:w,labelX:f,labelY:p,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:m,interactionWidth:g})});Tt.displayName="StraightEdge";function ot(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function jt({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case z.Left:return[t-ot(t-o,i),n];case z.Right:return[t+ot(o-t,i),n];case z.Top:return[t,n-ot(n-s,i)];case z.Bottom:return[t,n+ot(s-n,i)]}}function Mn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,curvature:r=.25}){const[c,l]=jt({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,a]=jt({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,m,g,w]=Nn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:a});return[`M${e},${t} C${c},${l} ${u},${a} ${o},${s}`,d,m,g,w]}const lt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:m,markerEnd:g,markerStart:w,pathOptions:f,interactionWidth:p})=>{const[y,x,N]=Mn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:f==null?void 0:f.curvature});return S.createElement(nt,{path:y,labelX:x,labelY:N,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:m,markerEnd:g,markerStart:w,interactionWidth:p})});lt.displayName="BezierEdge";const It=h.createContext(null),rs=It.Provider;It.Consumer;const is=()=>h.useContext(It),cs=e=>"id"in e&&"source"in e&&"target"in e,as=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Ct=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,ls=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),us=(e,t)=>{if(!e.source||!e.target)return t;let n;return cs(e)?n={...e}:n={...e,id:as(e)},ls(n,t)?t:t.concat(n)},Mt=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},An=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Ye=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Bt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Ye(s,t).positionAbsolute;return jo(o,Dt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return qo(n)},vn=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(a=>{const{width:d,height:m,selectable:g=!0,hidden:w=!1}=a;if(r&&!g||w)return!1;const{positionAbsolute:f}=Ye(a,c),p={x:f.x,y:f.y,width:d||0,height:m||0},y=wt(l,p),x=typeof d>"u"||typeof m>"u"||d===null||m===null,N=i&&y>0,C=(d||0)*(m||0);(x||N||y>=C||a.dragging)&&u.push(a)}),u},Pn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},$n=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),u=Ze(l,o,s),a=e.x+e.width/2,d=e.y+e.height/2,m=t/2-a*u,g=n/2-d*u;return{x:m,y:g,zoom:u}},De=(e,t=0)=>e.transition().duration(t);function qt(e,t,n,o){return(t[n]||[]).reduce((s,i)=>{var r,c;return`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((r=e.positionAbsolute)==null?void 0:r.x)??0)+i.x+i.width/2,y:(((c=e.positionAbsolute)==null?void 0:c.y)??0)+i.y+i.height/2}),s},[])}function ds(e,t,n,o,s,i){const{x:r,y:c}=be(e),u=t.elementsFromPoint(r,c).find(w=>w.classList.contains("react-flow__handle"));if(u){const w=u.getAttribute("data-nodeid");if(w){const f=Ht(void 0,u),p=u.getAttribute("data-handleid"),y=i({nodeId:w,id:p,type:f});if(y){const x=s.find(N=>N.nodeId===w&&N.type===f&&N.id===p);return{handle:{id:p,type:f,nodeId:w,x:(x==null?void 0:x.x)||n.x,y:(x==null?void 0:x.y)||n.y},validHandleResult:y}}}}let a=[],d=1/0;if(s.forEach(w=>{const f=Math.sqrt((w.x-n.x)**2+(w.y-n.y)**2);if(f<=o){const p=i(w);f<=d&&(f<d?a=[{handle:w,validHandleResult:p}]:f===d&&a.push({handle:w,validHandleResult:p}),d=f)}}),!a.length)return{handle:null,validHandleResult:kn()};if(a.length===1)return a[0];const m=a.some(({validHandleResult:w})=>w.isValid),g=a.some(({handle:w})=>w.type==="target");return a.find(({handle:w,validHandleResult:f})=>g?w.type==="target":m?f.isValid:!0)||a[0]}const fs={source:null,target:null,sourceHandle:null,targetHandle:null},kn=()=>({handleDomNode:null,isValid:!1,connection:fs,endHandle:null});function Dn(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...kn(),handleDomNode:l};if(l){const a=Ht(void 0,l),d=l.getAttribute("data-nodeid"),m=l.getAttribute("data-handleid"),g=l.classList.contains("connectable"),w=l.classList.contains("connectableend"),f={source:c?d:n,sourceHandle:c?m:o,target:c?n:d,targetHandle:c?o:m};u.connection=f,g&&w&&(t===Re.Strict?c&&a==="source"||!c&&a==="target":d!==n||m!==o)&&(u.endHandle={nodeId:d,handleId:m,type:a},u.isValid=i(f))}return u}function gs({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[q]){const{handleBounds:r}=i[q];let c=[],l=[];r&&(c=qt(i,r,"source",`${t}-${n}-${o}`),l=qt(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function Ht(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ht(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ms(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function _n({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onEdgeUpdateEnd:u}){const a=Sn(e.target),{connectionMode:d,domNode:m,autoPanOnConnect:g,connectionRadius:w,onConnectStart:f,panBy:p,getNodes:y,cancelConnection:x}=i();let N=0,C;const{x:D,y:I}=be(e),$=a==null?void 0:a.elementFromPoint(D,I),M=Ht(l,$),A=m==null?void 0:m.getBoundingClientRect();if(!A||!M)return;let B,_=be(e,A),R=!1,E=null,P=!1,k=null;const L=gs({nodes:y(),nodeId:n,handleId:t,handleType:M}),Y=()=>{if(!g)return;const[T,v]=xn(_,A);p({x:T,y:v}),N=requestAnimationFrame(Y)};r({connectionPosition:_,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:M,connectionStartHandle:{nodeId:n,handleId:t,type:M},connectionEndHandle:null}),f==null||f(e,{nodeId:n,handleId:t,handleType:M});function V(T){const{transform:v}=i();_=be(T,A);const{handle:H,validHandleResult:F}=ds(T,a,Mt(_,v,!1,[1,1]),w,L,X=>Dn(X,d,n,t,s?"target":"source",c,a));if(C=H,R||(Y(),R=!0),k=F.handleDomNode,E=F.connection,P=F.isValid,r({connectionPosition:C&&P?An({x:C.x,y:C.y},v):_,connectionStatus:ms(!!C,P),connectionEndHandle:F.endHandle}),!C&&!P&&!k)return ht(B);E.source!==E.target&&k&&(ht(B),B=k,k.classList.add("connecting","react-flow__handle-connecting"),k.classList.toggle("valid",P),k.classList.toggle("react-flow__handle-valid",P))}function b(T){var v,H;(C||k)&&E&&P&&(o==null||o(E)),(H=(v=i()).onConnectEnd)==null||H.call(v,T),l&&(u==null||u(T)),ht(B),x(),cancelAnimationFrame(N),R=!1,P=!1,E=null,k=null,a.removeEventListener("mousemove",V),a.removeEventListener("mouseup",b),a.removeEventListener("touchmove",V),a.removeEventListener("touchend",b)}a.addEventListener("mousemove",V),a.addEventListener("mouseup",b),a.addEventListener("touchmove",V),a.addEventListener("touchend",b)}const Qt=()=>!0,ps=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),hs=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n}},Rn=h.forwardRef(({type:e="source",position:t=z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:u,onMouseDown:a,onTouchStart:d,...m},g)=>{var A,B;const w=r||null,f=e==="target",p=ne(),y=is(),{connectOnClick:x,noPanClassName:N}=G(ps,se),{connecting:C,clickConnecting:D}=G(hs(y,w,e),se);y||(B=(A=p.getState()).onError)==null||B.call(A,"010",he.error010());const I=_=>{const{defaultEdgeOptions:R,onConnect:E,hasDefaultEdges:P}=p.getState(),k={...R,..._};if(P){const{edges:L,setEdges:Y}=p.getState();Y(us(k,L))}E==null||E(k),c==null||c(k)},$=_=>{if(!y)return;const R=wn(_);s&&(R&&_.button===0||!R)&&_n({event:_,handleId:w,nodeId:y,onConnect:I,isTarget:f,getState:p.getState,setState:p.setState,isValidConnection:n||p.getState().isValidConnection||Qt}),R?a==null||a(_):d==null||d(_)},M=_=>{const{onClickConnectStart:R,onClickConnectEnd:E,connectionClickStartHandle:P,connectionMode:k,isValidConnection:L}=p.getState();if(!y||!P&&!s)return;if(!P){R==null||R(_,{nodeId:y,handleId:w,handleType:e}),p.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:w}});return}const Y=Sn(_.target),V=n||L||Qt,{connection:b,isValid:T}=Dn({nodeId:y,id:w,type:e},k,P.nodeId,P.handleId||null,P.type,V,Y);T&&I(b),E==null||E(_),p.setState({connectionClickStartHandle:null})};return S.createElement("div",{"data-handleid":w,"data-nodeid":y,"data-handlepos":t,"data-id":`${y}-${w}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!f,target:f,connectable:o,connectablestart:s,connectableend:i,connecting:D,connectionindicator:o&&(s&&!C||i&&C)}]),onMouseDown:$,onTouchStart:$,onClick:x?M:void 0,ref:g,...m},l)});Rn.displayName="Handle";var ut=h.memo(Rn);const Tn=({data:e,isConnectable:t,targetPosition:n=z.Top,sourcePosition:o=z.Bottom})=>S.createElement(S.Fragment,null,S.createElement(ut,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,S.createElement(ut,{type:"source",position:o,isConnectable:t}));Tn.displayName="DefaultNode";var At=h.memo(Tn);const In=({data:e,isConnectable:t,sourcePosition:n=z.Bottom})=>S.createElement(S.Fragment,null,e==null?void 0:e.label,S.createElement(ut,{type:"source",position:n,isConnectable:t}));In.displayName="InputNode";var Bn=h.memo(In);const Hn=({data:e,isConnectable:t,targetPosition:n=z.Top})=>S.createElement(S.Fragment,null,S.createElement(ut,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Hn.displayName="OutputNode";var zn=h.memo(Hn);const zt=()=>null;zt.displayName="GroupNode";const ys=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),st=e=>e.id;function xs(e,t){return se(e.selectedNodes.map(st),t.selectedNodes.map(st))&&se(e.selectedEdges.map(st),t.selectedEdges.map(st))}const Ln=h.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=G(ys,xs);return h.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});Ln.displayName="SelectionListener";const Ss=e=>!!e.onSelectionChange;function Es({onSelectionChange:e}){const t=G(Ss);return e||t?S.createElement(Ln,{onSelectionChange:e}):null}const ws=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function He(e,t){h.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Z(e,t,n){h.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const bs=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:a,nodesFocusable:d,edgesFocusable:m,edgesUpdatable:g,elevateNodesOnSelect:w,minZoom:f,maxZoom:p,nodeExtent:y,onNodesChange:x,onEdgesChange:N,elementsSelectable:C,connectionMode:D,snapGrid:I,snapToGrid:$,translateExtent:M,connectOnClick:A,defaultEdgeOptions:B,fitView:_,fitViewOptions:R,onNodesDelete:E,onEdgesDelete:P,onNodeDrag:k,onNodeDragStart:L,onNodeDragStop:Y,onSelectionDrag:V,onSelectionDragStart:b,onSelectionDragStop:T,noPanClassName:v,nodeOrigin:H,rfId:F,autoPanOnConnect:X,autoPanOnNodeDrag:W,onError:j,connectionRadius:te,isValidConnection:Q,nodeDragThreshold:J})=>{const{setNodes:U,setEdges:re,setDefaultNodesAndEdges:ue,setMinZoom:fe,setMaxZoom:ee,setTranslateExtent:ge,setNodeExtent:K,reset:ie}=G(ws,se),O=ne();return h.useEffect(()=>{const Ne=o==null?void 0:o.map(Ce=>({...Ce,...B}));return ue(n,Ne),()=>{ie()}},[]),Z("defaultEdgeOptions",B,O.setState),Z("connectionMode",D,O.setState),Z("onConnect",s,O.setState),Z("onConnectStart",i,O.setState),Z("onConnectEnd",r,O.setState),Z("onClickConnectStart",c,O.setState),Z("onClickConnectEnd",l,O.setState),Z("nodesDraggable",u,O.setState),Z("nodesConnectable",a,O.setState),Z("nodesFocusable",d,O.setState),Z("edgesFocusable",m,O.setState),Z("edgesUpdatable",g,O.setState),Z("elementsSelectable",C,O.setState),Z("elevateNodesOnSelect",w,O.setState),Z("snapToGrid",$,O.setState),Z("snapGrid",I,O.setState),Z("onNodesChange",x,O.setState),Z("onEdgesChange",N,O.setState),Z("connectOnClick",A,O.setState),Z("fitViewOnInit",_,O.setState),Z("fitViewOnInitOptions",R,O.setState),Z("onNodesDelete",E,O.setState),Z("onEdgesDelete",P,O.setState),Z("onNodeDrag",k,O.setState),Z("onNodeDragStart",L,O.setState),Z("onNodeDragStop",Y,O.setState),Z("onSelectionDrag",V,O.setState),Z("onSelectionDragStart",b,O.setState),Z("onSelectionDragStop",T,O.setState),Z("noPanClassName",v,O.setState),Z("nodeOrigin",H,O.setState),Z("rfId",F,O.setState),Z("autoPanOnConnect",X,O.setState),Z("autoPanOnNodeDrag",W,O.setState),Z("onError",j,O.setState),Z("connectionRadius",te,O.setState),Z("isValidConnection",Q,O.setState),Z("nodeDragThreshold",J,O.setState),He(e,U),He(t,re),He(f,fe),He(p,ee),He(M,ge),He(y,K),null},Jt={display:"none"},Ns={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Vn="react-flow__node-desc",On="react-flow__edge-desc",Cs="react-flow__aria-live",Ms=e=>e.ariaLiveMessage;function As({rfId:e}){const t=G(Ms);return S.createElement("div",{id:`${Cs}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ns},t)}function vs({rfId:e,disableKeyboardA11y:t}){return S.createElement(S.Fragment,null,S.createElement("div",{id:`${Vn}-${e}`,style:Jt},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),S.createElement("div",{id:`${On}-${e}`,style:Jt},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&S.createElement(As,{rfId:e}))}var tt=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=h.useState(!1),s=h.useRef(!1),i=h.useRef(new Set([])),[r,c]=h.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),a=u.reduce((d,m)=>d.concat(...m),[]);return[u,a]}return[[],[]]},[e]);return h.useEffect(()=>{const l=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||l;if(e!==null){const a=g=>{if(s.current=g.ctrlKey||g.metaKey||g.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&bt(g))return!1;const f=tn(g.code,c);i.current.add(g[f]),en(r,i.current,!1)&&(g.preventDefault(),o(!0))},d=g=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&bt(g))return!1;const f=tn(g.code,c);en(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(g[f]),g.key==="Meta"&&i.current.clear(),s.current=!1},m=()=>{i.current.clear(),o(!1)};return u==null||u.addEventListener("keydown",a),u==null||u.addEventListener("keyup",d),window.addEventListener("blur",m),()=>{u==null||u.removeEventListener("keydown",a),u==null||u.removeEventListener("keyup",d),window.removeEventListener("blur",m)}}},[e,o]),n};function en(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function tn(e,t){return t.includes(e)?"code":"key"}function Fn(e,t,n,o){var r,c;if(!e.parentNode)return n;const s=t.get(e.parentNode),i=Ye(s,o);return Fn(s,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((r=s[q])==null?void 0:r.z)??0)>(n.z??0)?((c=s[q])==null?void 0:c.z)??0:n.z??0},o)}function Yn(e,t,n){e.forEach(o=>{var s;if(o.parentNode&&!e.has(o.parentNode))throw new Error(`Parent node ${o.parentNode} not found`);if(o.parentNode||n!=null&&n[o.id]){const{x:i,y:r,z:c}=Fn(o,e,{...o.position,z:((s=o[q])==null?void 0:s.z)??0},t);o.positionAbsolute={x:i,y:r},o[q].z=c,n!=null&&n[o.id]&&(o[q].isParent=!0)}})}function yt(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{var m;const l=(le(c.zIndex)?c.zIndex:0)+(c.selected?r:0),u=t.get(c.id),a={...c,positionAbsolute:{x:c.position.x,y:c.position.y}};c.parentNode&&(i[c.parentNode]=!0);const d=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==c.type;Object.defineProperty(a,q,{enumerable:!1,value:{handleBounds:d||(m=u==null?void 0:u[q])==null?void 0:m.handleBounds,z:l}}),s.set(c.id,a)}),Yn(s,n,i),s}function Xn(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:a,nodeOrigin:d}=e(),m=t.initial&&!u&&a;if(c&&l&&(m||!t.initial)){const w=n().filter(p=>{var x;const y=t.includeHiddenNodes?p.width&&p.height:!p.hidden;return(x=t.nodes)!=null&&x.length?y&&t.nodes.some(N=>N.id===p.id):y}),f=w.every(p=>p.width&&p.height);if(w.length>0&&f){const p=Bt(w,d),{x:y,y:x,zoom:N}=$n(p,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),C=Fe.translate(y,x).scale(N);return typeof t.duration=="number"&&t.duration>0?c.transform(De(l,t.duration),C):c.transform(l,C),!0}}return!1}function Ps(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[q]:o[q],selected:n.selected})}),new Map(t)}function $s(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function rt({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:u}=n();e!=null&&e.length&&(l&&o({nodeInternals:Ps(e,s)}),r==null||r(e)),t!=null&&t.length&&(u&&o({edges:$s(t,i)}),c==null||c(t))}const ze=()=>{},ks={zoomIn:ze,zoomOut:ze,zoomTo:ze,getZoom:()=>1,setViewport:ze,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:ze,fitBounds:ze,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Ds=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),_s=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=G(Ds,se);return h.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(De(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(De(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(De(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,u=Fe.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform(De(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Xn(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:u}=e.getState(),a=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:u,d=c/2-s*a,m=l/2-i*a,g=Fe.translate(d,m).scale(a);t.transform(De(n,r==null?void 0:r.duration),g)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:u}=e.getState(),{x:a,y:d,zoom:m}=$n(s,r,c,l,u,(i==null?void 0:i.padding)??.1),g=Fe.translate(a,d).scale(m);t.transform(De(n,i==null?void 0:i.duration),g)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Mt(s,i,r,c)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:c,domNode:l}=e.getState();if(!l)return s;const{x:u,y:a}=l.getBoundingClientRect(),d={x:s.x-u,y:s.y-a};return Mt(d,i,r,c)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:c,y:l}=r.getBoundingClientRect(),u=An(s,i);return{x:u.x+c,y:u.y+l}},viewportInitialized:!0}:ks,[t,n])};function Lt(){const e=_s(),t=ne(),n=h.useCallback(()=>t.getState().getNodes().map(f=>({...f})),[]),o=h.useCallback(f=>t.getState().nodeInternals.get(f),[]),s=h.useCallback(()=>{const{edges:f=[]}=t.getState();return f.map(p=>({...p}))},[]),i=h.useCallback(f=>{const{edges:p=[]}=t.getState();return p.find(y=>y.id===f)},[]),r=h.useCallback(f=>{const{getNodes:p,setNodes:y,hasDefaultNodes:x,onNodesChange:N}=t.getState(),C=p(),D=typeof f=="function"?f(C):f;if(x)y(D);else if(N){const I=D.length===0?C.map($=>({type:"remove",id:$.id})):D.map($=>({item:$,type:"reset"}));N(I)}},[]),c=h.useCallback(f=>{const{edges:p=[],setEdges:y,hasDefaultEdges:x,onEdgesChange:N}=t.getState(),C=typeof f=="function"?f(p):f;if(x)y(C);else if(N){const D=C.length===0?p.map(I=>({type:"remove",id:I.id})):C.map(I=>({item:I,type:"reset"}));N(D)}},[]),l=h.useCallback(f=>{const p=Array.isArray(f)?f:[f],{getNodes:y,setNodes:x,hasDefaultNodes:N,onNodesChange:C}=t.getState();if(N){const I=[...y(),...p];x(I)}else if(C){const D=p.map(I=>({item:I,type:"add"}));C(D)}},[]),u=h.useCallback(f=>{const p=Array.isArray(f)?f:[f],{edges:y=[],setEdges:x,hasDefaultEdges:N,onEdgesChange:C}=t.getState();if(N)x([...y,...p]);else if(C){const D=p.map(I=>({item:I,type:"add"}));C(D)}},[]),a=h.useCallback(()=>{const{getNodes:f,edges:p=[],transform:y}=t.getState(),[x,N,C]=y;return{nodes:f().map(D=>({...D})),edges:p.map(D=>({...D})),viewport:{x,y:N,zoom:C}}},[]),d=h.useCallback(({nodes:f,edges:p})=>{const{nodeInternals:y,getNodes:x,edges:N,hasDefaultNodes:C,hasDefaultEdges:D,onNodesDelete:I,onEdgesDelete:$,onNodesChange:M,onEdgesChange:A}=t.getState(),B=(f||[]).map(k=>k.id),_=(p||[]).map(k=>k.id),R=x().reduce((k,L)=>{const Y=!B.includes(L.id)&&L.parentNode&&k.find(b=>b.id===L.parentNode);return(typeof L.deletable=="boolean"?L.deletable:!0)&&(B.includes(L.id)||Y)&&k.push(L),k},[]),E=N.filter(k=>typeof k.deletable=="boolean"?k.deletable:!0),P=E.filter(k=>_.includes(k.id));if(R||P){const k=Pn(R,E),L=[...P,...k],Y=L.reduce((V,b)=>(V.includes(b.id)||V.push(b.id),V),[]);if((D||C)&&(D&&t.setState({edges:N.filter(V=>!Y.includes(V.id))}),C&&(R.forEach(V=>{y.delete(V.id)}),t.setState({nodeInternals:new Map(y)}))),Y.length>0&&($==null||$(L),A&&A(Y.map(V=>({id:V,type:"remove"})))),R.length>0&&(I==null||I(R),M)){const V=R.map(b=>({id:b.id,type:"remove"}));M(V)}}},[]),m=h.useCallback(f=>{const p=Qo(f),y=p?null:t.getState().nodeInternals.get(f.id);return!p&&!y?[null,null,p]:[p?f:Wt(y),y,p]},[]),g=h.useCallback((f,p=!0,y)=>{const[x,N,C]=m(f);return x?(y||t.getState().getNodes()).filter(D=>{if(!C&&(D.id===N.id||!D.positionAbsolute))return!1;const I=Wt(D),$=wt(I,x);return p&&$>0||$>=x.width*x.height}):[]},[]),w=h.useCallback((f,p,y=!0)=>{const[x]=m(f);if(!x)return!1;const N=wt(x,p);return y&&N>0||N>=x.width*x.height},[]);return h.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:u,toObject:a,deleteElements:d,getIntersectingNodes:g,isNodeIntersecting:w}),[e,n,o,s,i,r,c,l,u,a,d,g,w])}const Rs={actInsideInputWithModifier:!1};var Ts=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=Lt(),s=tt(e,Rs),i=tt(t);h.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),u=r.filter(a=>a.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),h.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Is(e){const t=ne();h.useEffect(()=>{let n;const o=()=>{var i,r;if(!e.current)return;const s=$t(e.current);(s.height===0||s.width===0)&&((r=(i=t.getState()).onError)==null||r.call(i,"004",he.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Vt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Bs=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,it=e=>({x:e.x,y:e.y,zoom:e.k}),Le=(e,t)=>e.target.closest(`.${t}`),nn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),on=e=>{const t=e.ctrlKey&&ct()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Hs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),zs=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=_e.Free,zoomOnDoubleClick:u=!0,elementsSelectable:a,panOnDrag:d=!0,defaultViewport:m,translateExtent:g,minZoom:w,maxZoom:f,zoomActivationKeyCode:p,preventScrolling:y=!0,children:x,noWheelClassName:N,noPanClassName:C})=>{const D=h.useRef(),I=ne(),$=h.useRef(!1),M=h.useRef(!1),A=h.useRef(null),B=h.useRef({x:0,y:0,zoom:0}),{d3Zoom:_,d3Selection:R,d3ZoomHandler:E,userSelectionActive:P}=G(Hs,se),k=tt(p),L=h.useRef(0),Y=h.useRef(!1),V=h.useRef();return Is(A),h.useEffect(()=>{if(A.current){const b=A.current.getBoundingClientRect(),T=Vo().scaleExtent([w,f]).translateExtent(g),v=pn(A.current).call(T),H=Fe.translate(m.x,m.y).scale(Ze(m.zoom,w,f)),F=[[0,0],[b.width,b.height]],X=T.constrain()(H,F,g);T.transform(v,X),T.wheelDelta(on),I.setState({d3Zoom:T,d3Selection:v,d3ZoomHandler:v.on("wheel.zoom"),transform:[X.x,X.y,X.k],domNode:A.current.closest(".react-flow")})}},[]),h.useEffect(()=>{R&&_&&(r&&!k&&!P?R.on("wheel.zoom",b=>{if(Le(b,N))return!1;b.preventDefault(),b.stopImmediatePropagation();const T=R.property("__zoom").k||1,v=ct();if(b.ctrlKey&&i&&v){const J=Yo(b),U=on(b),re=T*Math.pow(2,U);_.scaleTo(R,re,J,b);return}const H=b.deltaMode===1?20:1;let F=l===_e.Vertical?0:b.deltaX*H,X=l===_e.Horizontal?0:b.deltaY*H;!v&&b.shiftKey&&l!==_e.Vertical&&(F=b.deltaY*H,X=0),_.translateBy(R,-(F/T)*c,-(X/T)*c,{internal:!0});const W=it(R.property("__zoom")),{onViewportChangeStart:j,onViewportChange:te,onViewportChangeEnd:Q}=I.getState();clearTimeout(V.current),Y.current||(Y.current=!0,t==null||t(b,W),j==null||j(W)),Y.current&&(e==null||e(b,W),te==null||te(W),V.current=setTimeout(()=>{n==null||n(b,W),Q==null||Q(W),Y.current=!1},150))},{passive:!1}):typeof E<"u"&&R.on("wheel.zoom",function(b,T){if(!y||Le(b,N))return null;b.preventDefault(),E.call(this,b,T)},{passive:!1}))},[P,r,l,R,_,E,k,i,y,N,t,e,n]),h.useEffect(()=>{_&&_.on("start",b=>{var H,F;if(!b.sourceEvent||b.sourceEvent.internal)return null;L.current=(H=b.sourceEvent)==null?void 0:H.button;const{onViewportChangeStart:T}=I.getState(),v=it(b.transform);$.current=!0,B.current=v,((F=b.sourceEvent)==null?void 0:F.type)==="mousedown"&&I.setState({paneDragging:!0}),T==null||T(v),t==null||t(b.sourceEvent,v)})},[_,t]),h.useEffect(()=>{_&&(P&&!$.current?_.on("zoom",null):P||_.on("zoom",b=>{var v;const{onViewportChange:T}=I.getState();if(I.setState({transform:[b.transform.x,b.transform.y,b.transform.k]}),M.current=!!(o&&nn(d,L.current??0)),(e||T)&&!((v=b.sourceEvent)!=null&&v.internal)){const H=it(b.transform);T==null||T(H),e==null||e(b.sourceEvent,H)}}))},[P,_,e,d,o]),h.useEffect(()=>{_&&_.on("end",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;const{onViewportChangeEnd:T}=I.getState();if($.current=!1,I.setState({paneDragging:!1}),o&&nn(d,L.current??0)&&!M.current&&o(b.sourceEvent),M.current=!1,(n||T)&&Bs(B.current,b.transform)){const v=it(b.transform);B.current=v,clearTimeout(D.current),D.current=setTimeout(()=>{T==null||T(v),n==null||n(b.sourceEvent,v)},r?150:0)}})},[_,r,d,n,o]),h.useEffect(()=>{_&&_.filter(b=>{const T=k||s,v=i&&b.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&b.button===1&&b.type==="mousedown"&&(Le(b,"react-flow__node")||Le(b,"react-flow__edge")))return!0;if(!d&&!T&&!r&&!u&&!i||P||!u&&b.type==="dblclick"||Le(b,N)&&b.type==="wheel"||Le(b,C)&&(b.type!=="wheel"||r&&b.type==="wheel"&&!k)||!i&&b.ctrlKey&&b.type==="wheel"||!T&&!r&&!v&&b.type==="wheel"||!d&&(b.type==="mousedown"||b.type==="touchstart")||Array.isArray(d)&&!d.includes(b.button)&&(b.type==="mousedown"||b.type==="touchstart"))return!1;const H=Array.isArray(d)&&d.includes(b.button)||!b.button||b.button<=1;return(!b.ctrlKey||b.type==="wheel")&&H})},[P,_,s,i,r,u,d,a,k]),S.createElement("div",{className:"react-flow__renderer",ref:A,style:Vt},x)},Ls=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Vs(){const{userSelectionActive:e,userSelectionRect:t}=G(Ls,se);return e&&t?S.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function sn(e,t){const n=e.find(o=>o.id===t.parentNode);if(n){const o=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(o>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,o>0&&(n.style.width+=o),s>0&&(n.style.height+=s),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function Zn(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&sn(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&sn(o,r);break}case"remove":return o}return o.push(r),o},n)}function Wn(e,t){return Zn(e,t)}function Os(e,t){return Zn(e,t)}const Ee=(e,t)=>({id:e,type:"select",selected:t});function Oe(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(Ee(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(Ee(o.id,!1))),n},[])}const xt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Fs=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Kn=h.memo(({isSelecting:e,selectionMode:t=et.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:a,children:d})=>{const m=h.useRef(null),g=ne(),w=h.useRef(0),f=h.useRef(0),p=h.useRef(),{userSelectionActive:y,elementsSelectable:x,dragging:N}=G(Fs,se),C=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),w.current=0,f.current=0},D=E=>{i==null||i(E),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},I=E=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){E.preventDefault();return}r==null||r(E)},$=c?E=>c(E):void 0,M=E=>{const{resetSelectedElements:P,domNode:k}=g.getState();if(p.current=k==null?void 0:k.getBoundingClientRect(),!x||!e||E.button!==0||E.target!==m.current||!p.current)return;const{x:L,y:Y}=be(E,p.current);P(),g.setState({userSelectionRect:{width:0,height:0,startX:L,startY:Y,x:L,y:Y}}),o==null||o(E)},A=E=>{const{userSelectionRect:P,nodeInternals:k,edges:L,transform:Y,onNodesChange:V,onEdgesChange:b,nodeOrigin:T,getNodes:v}=g.getState();if(!e||!p.current||!P)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const H=be(E,p.current),F=P.startX??0,X=P.startY??0,W={...P,x:H.x<F?H.x:F,y:H.y<X?H.y:X,width:Math.abs(H.x-F),height:Math.abs(H.y-X)},j=v(),te=vn(k,W,Y,t===et.Partial,!0,T),Q=Pn(te,L).map(U=>U.id),J=te.map(U=>U.id);if(w.current!==J.length){w.current=J.length;const U=Oe(j,J);U.length&&(V==null||V(U))}if(f.current!==Q.length){f.current=Q.length;const U=Oe(L,Q);U.length&&(b==null||b(U))}g.setState({userSelectionRect:W})},B=E=>{if(E.button!==0)return;const{userSelectionRect:P}=g.getState();!y&&P&&E.target===m.current&&(D==null||D(E)),g.setState({nodesSelectionActive:w.current>0}),C(),s==null||s(E)},_=E=>{y&&(g.setState({nodesSelectionActive:w.current>0}),s==null||s(E)),C()},R=x&&(e||y);return S.createElement("div",{className:ce(["react-flow__pane",{dragging:N,selection:e}]),onClick:R?void 0:xt(D,m),onContextMenu:xt(I,m),onWheel:xt($,m),onMouseEnter:R?void 0:l,onMouseDown:R?M:void 0,onMouseMove:R?A:u,onMouseUp:R?B:void 0,onMouseLeave:R?_:a,ref:m,style:Vt},d,S.createElement(Vs,null))});Kn.displayName="Pane";function Un(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:Un(n,t):!1}function rn(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Ys(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||!Un(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,r;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((r=s.positionAbsolute)==null?void 0:r.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height,expandParent:s.expandParent}})}function Xs(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Gn(e,t,n,o,s=[0,0],i){const r=Xs(e,e.extent||o);let c=r;if(e.extent==="parent"&&!e.expandParent)if(e.parentNode&&e.width&&e.height){const a=n.get(e.parentNode),{x:d,y:m}=Ye(a,s).positionAbsolute;c=a&&le(d)&&le(m)&&le(a.width)&&le(a.height)?[[d+e.width*s[0],m+e.height*s[1]],[d+a.width-e.width+e.width*s[0],m+a.height-e.height+e.height*s[1]]]:c}else i==null||i("005",he.error005()),c=r;else if(e.extent&&e.parentNode&&e.extent!=="parent"){const a=n.get(e.parentNode),{x:d,y:m}=Ye(a,s).positionAbsolute;c=[[e.extent[0][0]+d,e.extent[0][1]+m],[e.extent[1][0]+d,e.extent[1][1]+m]]}let l={x:0,y:0};if(e.parentNode){const a=n.get(e.parentNode);l=Ye(a,s).positionAbsolute}const u=c&&c!=="parent"?kt(t,c):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function St({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const cn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-r.left-c.x)/n,y:(u.top-r.top-c.y)/n,...$t(l)}})};function qe(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function vt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),u=c.get(e);if(!u){l==null||l("012",he.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var a;return(a=o==null?void 0:o.current)==null?void 0:a.blur()})):s([e])}function Zs(){const e=ne();return h.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function Et(e){return(t,n,o)=>e==null?void 0:e(t,o)}function jn({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[l,u]=h.useState(!1),a=h.useRef([]),d=h.useRef({x:null,y:null}),m=h.useRef(0),g=h.useRef(null),w=h.useRef({x:0,y:0}),f=h.useRef(null),p=h.useRef(!1),y=h.useRef(!1),x=Zs();return h.useEffect(()=>{if(e!=null&&e.current){const N=pn(e.current),C=({x:$,y:M})=>{const{nodeInternals:A,onNodeDrag:B,onSelectionDrag:_,updateNodePositions:R,nodeExtent:E,snapGrid:P,snapToGrid:k,nodeOrigin:L,onError:Y}=c.getState();d.current={x:$,y:M};let V=!1,b={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&E){const v=Bt(a.current,L);b=Dt(v)}if(a.current=a.current.map(v=>{const H={x:$-v.distance.x,y:M-v.distance.y};k&&(H.x=P[0]*Math.round(H.x/P[0]),H.y=P[1]*Math.round(H.y/P[1]));const F=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];a.current.length>1&&E&&!v.extent&&(F[0][0]=v.positionAbsolute.x-b.x+E[0][0],F[1][0]=v.positionAbsolute.x+(v.width??0)-b.x2+E[1][0],F[0][1]=v.positionAbsolute.y-b.y+E[0][1],F[1][1]=v.positionAbsolute.y+(v.height??0)-b.y2+E[1][1]);const X=Gn(v,H,A,F,L,Y);return V=V||v.position.x!==X.position.x||v.position.y!==X.position.y,v.position=X.position,v.positionAbsolute=X.positionAbsolute,v}),!V)return;R(a.current,!0,!0),u(!0);const T=s?B:Et(_);if(T&&f.current){const[v,H]=St({nodeId:s,dragItems:a.current,nodeInternals:A});T(f.current,v,H)}},D=()=>{if(!g.current)return;const[$,M]=xn(w.current,g.current);if($!==0||M!==0){const{transform:A,panBy:B}=c.getState();d.current.x=(d.current.x??0)-$/A[2],d.current.y=(d.current.y??0)-M/A[2],B({x:$,y:M})&&C(d.current)}m.current=requestAnimationFrame(D)},I=$=>{var L;const{nodeInternals:M,multiSelectionActive:A,nodesDraggable:B,unselectNodesAndEdges:_,onNodeDragStart:R,onSelectionDragStart:E}=c.getState();y.current=!0;const P=s?R:Et(E);(!r||!i)&&!A&&s&&((L=M.get(s))!=null&&L.selected||_()),s&&i&&r&&vt({id:s,store:c,nodeRef:e});const k=x($);if(d.current=k,a.current=Ys(M,B,k,s),P&&a.current){const[Y,V]=St({nodeId:s,dragItems:a.current,nodeInternals:M});P($.sourceEvent,Y,V)}};if(t)N.on(".drag",null);else{const $=Xo().on("start",M=>{const{domNode:A,nodeDragThreshold:B}=c.getState();B===0&&I(M);const _=x(M);d.current=_,g.current=(A==null?void 0:A.getBoundingClientRect())||null,w.current=be(M.sourceEvent,g.current)}).on("drag",M=>{var R,E;const A=x(M),{autoPanOnNodeDrag:B,nodeDragThreshold:_}=c.getState();if(!p.current&&y.current&&B&&(p.current=!0,D()),!y.current){const P=A.xSnapped-(((R=d==null?void 0:d.current)==null?void 0:R.x)??0),k=A.ySnapped-(((E=d==null?void 0:d.current)==null?void 0:E.y)??0);Math.sqrt(P*P+k*k)>_&&I(M)}(d.current.x!==A.xSnapped||d.current.y!==A.ySnapped)&&a.current&&y.current&&(f.current=M.sourceEvent,w.current=be(M.sourceEvent,g.current),C(A))}).on("end",M=>{if(y.current&&(u(!1),p.current=!1,y.current=!1,cancelAnimationFrame(m.current),a.current)){const{updateNodePositions:A,nodeInternals:B,onNodeDragStop:_,onSelectionDragStop:R}=c.getState(),E=s?_:Et(R);if(A(a.current,!1,!1),E){const[P,k]=St({nodeId:s,dragItems:a.current,nodeInternals:B});E(M.sourceEvent,P,k)}}}).filter(M=>{const A=M.target;return!M.button&&(!n||!rn(A,`.${n}`,e))&&(!o||rn(A,o,e))});return N.call($),()=>{N.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,x]),l}function qn(){const e=ne();return h.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:u,nodesDraggable:a}=e.getState(),d=r().filter(x=>x.selected&&(x.draggable||a&&typeof x.draggable>"u")),m=c?l[0]:5,g=c?l[1]:5,w=n.isShiftPressed?4:1,f=n.x*m*w,p=n.y*g*w,y=d.map(x=>{if(x.positionAbsolute){const N={x:x.positionAbsolute.x+f,y:x.positionAbsolute.y+p};c&&(N.x=l[0]*Math.round(N.x/l[0]),N.y=l[1]*Math.round(N.y/l[1]));const{positionAbsolute:C,position:D}=Gn(x,N,o,s,void 0,u);x.position=D,x.positionAbsolute=C}return x});i(y,!0,!1)},[])}const Xe={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Qe=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:u,onClick:a,onMouseEnter:d,onMouseMove:m,onMouseLeave:g,onContextMenu:w,onDoubleClick:f,style:p,className:y,isDraggable:x,isSelectable:N,isConnectable:C,isFocusable:D,selectNodesOnDrag:I,sourcePosition:$,targetPosition:M,hidden:A,resizeObserver:B,dragHandle:_,zIndex:R,isParent:E,noDragClassName:P,noPanClassName:k,initialized:L,disableKeyboardA11y:Y,ariaLabel:V,rfId:b,hasHandleBounds:T})=>{const v=ne(),H=h.useRef(null),F=h.useRef($),X=h.useRef(M),W=h.useRef(o),j=N||x||a||d||m||g,te=qn(),Q=qe(n,v.getState,d),J=qe(n,v.getState,m),U=qe(n,v.getState,g),re=qe(n,v.getState,w),ue=qe(n,v.getState,f),fe=K=>{const{nodeDragThreshold:ie}=v.getState();if(N&&(!I||!x||ie>0)&&vt({id:n,store:v,nodeRef:H}),a){const O=v.getState().nodeInternals.get(n);O&&a(K,{...O})}},ee=K=>{if(!bt(K))if(En.includes(K.key)&&N){const ie=K.key==="Escape";vt({id:n,store:v,unselect:ie,nodeRef:H})}else!Y&&x&&u&&Object.prototype.hasOwnProperty.call(Xe,K.key)&&(v.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),te({x:Xe[K.key].x,y:Xe[K.key].y,isShiftPressed:K.shiftKey}))};h.useEffect(()=>()=>{H.current&&(B==null||B.unobserve(H.current))},[]),h.useEffect(()=>{if(H.current&&!A){const K=H.current;(!L||!T)&&(B==null||B.unobserve(K),B==null||B.observe(K))}},[A,L,T]),h.useEffect(()=>{const K=W.current!==o,ie=F.current!==$,O=X.current!==M;H.current&&(K||ie||O)&&(K&&(W.current=o),ie&&(F.current=$),O&&(X.current=M),v.getState().updateNodeDimensions([{id:n,nodeElement:H.current,forceUpdate:!0}]))},[n,o,$,M]);const ge=jn({nodeRef:H,disabled:A||!x,noDragClassName:P,handleSelector:_,nodeId:n,isSelectable:N,selectNodesOnDrag:I});return A?null:S.createElement("div",{className:ce(["react-flow__node",`react-flow__node-${o}`,{[k]:x},y,{selected:u,selectable:N,parent:E,dragging:ge}]),ref:H,style:{zIndex:R,transform:`translate(${c}px,${l}px)`,pointerEvents:j?"all":"none",visibility:L?"visible":"hidden",...p},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Q,onMouseMove:J,onMouseLeave:U,onContextMenu:re,onClick:fe,onDoubleClick:ue,onKeyDown:D?ee:void 0,tabIndex:D?0:void 0,role:D?"button":void 0,"aria-describedby":Y?void 0:`${Vn}-${b}`,"aria-label":V},S.createElement(rs,{value:n},S.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:C,sourcePosition:$,targetPosition:M,dragging:ge,dragHandle:_,zIndex:R})))};return t.displayName="NodeWrapper",h.memo(t)};const Ws=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Bt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ks({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:u}=G(Ws,se),a=qn(),d=h.useRef(null);if(h.useEffect(()=>{var w;n||(w=d.current)==null||w.focus({preventScroll:!0})},[n]),jn({nodeRef:d}),u||!s||!i)return null;const m=e?w=>{const f=o.getState().getNodes().filter(p=>p.selected);e(w,f)}:void 0,g=w=>{Object.prototype.hasOwnProperty.call(Xe,w.key)&&a({x:Xe[w.key].x,y:Xe[w.key].y,isShiftPressed:w.shiftKey})};return S.createElement("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},S.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:g,style:{width:s,height:i,top:c,left:r}}))}var Us=h.memo(Ks);const Gs=e=>e.nodesSelectionActive,Qn=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:u,onMoveEnd:a,selectionKeyCode:d,selectionOnDrag:m,selectionMode:g,onSelectionStart:w,onSelectionEnd:f,multiSelectionKeyCode:p,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:D,panOnScroll:I,panOnScrollSpeed:$,panOnScrollMode:M,zoomOnDoubleClick:A,panOnDrag:B,defaultViewport:_,translateExtent:R,minZoom:E,maxZoom:P,preventScrolling:k,onSelectionContextMenu:L,noWheelClassName:Y,noPanClassName:V,disableKeyboardA11y:b})=>{const T=G(Gs),v=tt(d),H=tt(y),F=H||B,X=H||I,W=v||m&&F!==!0;return Ts({deleteKeyCode:c,multiSelectionKeyCode:p}),S.createElement(zs,{onMove:l,onMoveStart:u,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:D,panOnScroll:X,panOnScrollSpeed:$,panOnScrollMode:M,zoomOnDoubleClick:A,panOnDrag:!v&&F,defaultViewport:_,translateExtent:R,minZoom:E,maxZoom:P,zoomActivationKeyCode:x,preventScrolling:k,noWheelClassName:Y,noPanClassName:V},S.createElement(Kn,{onSelectionStart:w,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:F,isSelecting:!!W,selectionMode:g},e,T&&S.createElement(Us,{onSelectionContextMenu:L,noPanClassName:V,disableKeyboardA11y:b})))};Qn.displayName="FlowRenderer";var js=h.memo(Qn);function qs(e){return G(h.useCallback(n=>e?vn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Qs(e){const t={input:Qe(e.input||Bn),default:Qe(e.default||At),output:Qe(e.output||zn),group:Qe(e.group||zt)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Qe(e[i]||At),s),n);return{...t,...o}}const Js=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},er=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Jn=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=G(er,se),c=qs(e.onlyRenderVisibleElements),l=h.useRef(),u=h.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(d=>{const m=d.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));i(m)});return l.current=a,a},[]);return h.useEffect(()=>()=>{var a;(a=l==null?void 0:l.current)==null||a.disconnect()},[]),S.createElement("div",{className:"react-flow__nodes",style:Vt},c.map(a=>{var D,I,$;let d=a.type||"default";e.nodeTypes[d]||(r==null||r("003",he.error003(d)),d="default");const m=e.nodeTypes[d]||e.nodeTypes.default,g=!!(a.draggable||t&&typeof a.draggable>"u"),w=!!(a.selectable||s&&typeof a.selectable>"u"),f=!!(a.connectable||n&&typeof a.connectable>"u"),p=!!(a.focusable||o&&typeof a.focusable>"u"),y=e.nodeExtent?kt(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,x=(y==null?void 0:y.x)??0,N=(y==null?void 0:y.y)??0,C=Js({x,y:N,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return S.createElement(m,{key:a.id,id:a.id,className:a.className,style:a.style,type:d,data:a.data,sourcePosition:a.sourcePosition||z.Bottom,targetPosition:a.targetPosition||z.Top,hidden:a.hidden,xPos:x,yPos:N,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:g,isSelectable:w,isConnectable:f,isFocusable:p,resizeObserver:u,dragHandle:a.dragHandle,zIndex:((D=a[q])==null?void 0:D.z)??0,isParent:!!((I=a[q])!=null&&I.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!(($=a[q])!=null&&$.handleBounds)})}))};Jn.displayName="NodeRenderer";var tr=h.memo(Jn);const nr=(e,t,n)=>n===z.Left?e-t:n===z.Right?e+t:e,or=(e,t,n)=>n===z.Top?e-t:n===z.Bottom?e+t:e,an="react-flow__edgeupdater",ln=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>S.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:ce([an,`${an}-${c}`]),cx:nr(t,o,e),cy:or(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),sr=()=>!0;var Ve=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:m,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:f,style:p,source:y,target:x,sourceX:N,sourceY:C,targetX:D,targetY:I,sourcePosition:$,targetPosition:M,elementsSelectable:A,hidden:B,sourceHandleId:_,targetHandleId:R,onContextMenu:E,onMouseEnter:P,onMouseMove:k,onMouseLeave:L,edgeUpdaterRadius:Y,onEdgeUpdate:V,onEdgeUpdateStart:b,onEdgeUpdateEnd:T,markerEnd:v,markerStart:H,rfId:F,ariaLabel:X,isFocusable:W,isUpdatable:j,pathOptions:te,interactionWidth:Q})=>{const J=h.useRef(null),[U,re]=h.useState(!1),[ue,fe]=h.useState(!1),ee=ne(),ge=h.useMemo(()=>`url('#${Ct(H,F)}')`,[H,F]),K=h.useMemo(()=>`url('#${Ct(v,F)}')`,[v,F]);if(B)return null;const ie=oe=>{var me;const{edges:ae,addSelectedEdges:ve,unselectNodesAndEdges:Pe,multiSelectionActive:$e}=ee.getState(),pe=ae.find(Ue=>Ue.id===n);pe&&(A&&(ee.setState({nodesSelectionActive:!1}),pe.selected&&$e?(Pe({nodes:[],edges:[pe]}),(me=J.current)==null||me.blur()):ve([n])),r&&r(oe,pe))},O=je(n,ee.getState,c),Ne=je(n,ee.getState,E),Ce=je(n,ee.getState,P),We=je(n,ee.getState,k),Te=je(n,ee.getState,L),Me=(oe,ae)=>{if(oe.button!==0)return;const{edges:ve,isValidConnection:Pe}=ee.getState(),$e=ae?x:y,pe=(ae?R:_)||null,me=ae?"target":"source",Ue=Pe||sr,gt=ae,Ge=ve.find(ke=>ke.id===n);fe(!0),b==null||b(oe,Ge,me);const mt=ke=>{fe(!1),T==null||T(ke,Ge,me)};_n({event:oe,handleId:pe,nodeId:$e,onConnect:ke=>V==null?void 0:V(Ge,ke),isTarget:gt,getState:ee.getState,setState:ee.setState,isValidConnection:Ue,edgeUpdaterType:me,onEdgeUpdateEnd:mt})},ye=oe=>Me(oe,!0),Ie=oe=>Me(oe,!1),xe=()=>re(!0),Ae=()=>re(!1),Ke=!A&&!r,Be=oe=>{var ae;if(En.includes(oe.key)&&A){const{unselectNodesAndEdges:ve,addSelectedEdges:Pe,edges:$e}=ee.getState();oe.key==="Escape"?((ae=J.current)==null||ae.blur(),ve({edges:[$e.find(me=>me.id===n)]})):Pe([n])}};return S.createElement("g",{className:ce(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:Ke,updating:U}]),onClick:ie,onDoubleClick:O,onContextMenu:Ne,onMouseEnter:Ce,onMouseMove:We,onMouseLeave:Te,onKeyDown:W?Be:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":X===null?void 0:X||`Edge from ${y} to ${x}`,"aria-describedby":W?`${On}-${F}`:void 0,ref:J},!ue&&S.createElement(e,{id:n,source:y,target:x,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:m,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:f,data:i,style:p,sourceX:N,sourceY:C,targetX:D,targetY:I,sourcePosition:$,targetPosition:M,sourceHandleId:_,targetHandleId:R,markerStart:ge,markerEnd:K,pathOptions:te,interactionWidth:Q}),j&&S.createElement(S.Fragment,null,(j==="source"||j===!0)&&S.createElement(ln,{position:$,centerX:N,centerY:C,radius:Y,onMouseDown:ye,onMouseEnter:xe,onMouseOut:Ae,type:"source"}),(j==="target"||j===!0)&&S.createElement(ln,{position:M,centerX:D,centerY:I,radius:Y,onMouseDown:Ie,onMouseEnter:xe,onMouseOut:Ae,type:"target"})))};return t.displayName="EdgeWrapper",h.memo(t)};function rr(e){const t={default:Ve(e.default||lt),straight:Ve(e.bezier||Tt),step:Ve(e.step||Rt),smoothstep:Ve(e.step||ft),simplebezier:Ve(e.simplebezier||_t)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Ve(e[i]||lt),s),n);return{...t,...o}}function un(e,t,n=null){const o=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,r=(n==null?void 0:n.height)||t.height;switch(e){case z.Top:return{x:o+i/2,y:s};case z.Right:return{x:o+i,y:s+r/2};case z.Bottom:return{x:o+i/2,y:s+r};case z.Left:return{x:o,y:s+r/2}}}function dn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const ir=(e,t,n,o,s,i)=>{const r=un(n,e,t),c=un(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function cr({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const a=Dt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),d=Math.max(0,Math.min(a.x2,u.x2)-Math.max(a.x,u.x)),m=Math.max(0,Math.min(a.y2,u.y2)-Math.max(a.y,u.y));return Math.ceil(d*m)>0}function fn(e){var o,s,i,r,c;const t=((o=e==null?void 0:e[q])==null?void 0:o.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)||0,y:((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const ar=[{level:0,isMaxLevel:!0,edges:[]}];function lr(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{var a,d;const l=le(c.zIndex);let u=l?c.zIndex:0;if(n){const m=t.get(c.target),g=t.get(c.source),w=c.selected||(m==null?void 0:m.selected)||(g==null?void 0:g.selected),f=Math.max(((a=g==null?void 0:g[q])==null?void 0:a.z)||0,((d=m==null?void 0:m[q])==null?void 0:d.z)||0,1e3);u=(l?c.zIndex:0)+(w?f:0)}return r[u]?r[u].push(c):r[u]=[c],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?ar:i}function ur(e,t,n){const o=G(h.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return(r==null?void 0:r.width)&&(r==null?void 0:r.height)&&(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&cr({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return lr(o,t,n)}const dr=({color:e="none",strokeWidth:t=1})=>S.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),fr=({color:e="none",strokeWidth:t=1})=>S.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),gn={[at.Arrow]:dr,[at.ArrowClosed]:fr};function gr(e){const t=ne();return h.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(gn,e)?gn[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",he.error009(e)),null)},[e])}const mr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=gr(t);return l?S.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0"},S.createElement(l,{color:n,strokeWidth:r})):null},pr=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=Ct(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},eo=({defaultColor:e,rfId:t})=>{const n=G(h.useCallback(pr({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return S.createElement("defs",null,n.map(o=>S.createElement(mr,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};eo.displayName="MarkerDefinitions";var hr=h.memo(eo);const yr=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),to=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeUpdate:r,onEdgeContextMenu:c,onEdgeMouseEnter:l,onEdgeMouseMove:u,onEdgeMouseLeave:a,onEdgeClick:d,edgeUpdaterRadius:m,onEdgeDoubleClick:g,onEdgeUpdateStart:w,onEdgeUpdateEnd:f,children:p})=>{const{edgesFocusable:y,edgesUpdatable:x,elementsSelectable:N,width:C,height:D,connectionMode:I,nodeInternals:$,onError:M}=G(yr,se),A=ur(t,$,n);return C?S.createElement(S.Fragment,null,A.map(({level:B,edges:_,isMaxLevel:R})=>S.createElement("svg",{key:B,style:{zIndex:B},width:C,height:D,className:"react-flow__edges react-flow__container"},R&&S.createElement(hr,{defaultColor:e,rfId:o}),S.createElement("g",null,_.map(E=>{const[P,k,L]=fn($.get(E.source)),[Y,V,b]=fn($.get(E.target));if(!L||!b)return null;let T=E.type||"default";s[T]||(M==null||M("011",he.error011(T)),T="default");const v=s[T]||s.default,H=I===Re.Strict?V.target:(V.target??[]).concat(V.source??[]),F=dn(k.source,E.sourceHandle),X=dn(H,E.targetHandle),W=(F==null?void 0:F.position)||z.Bottom,j=(X==null?void 0:X.position)||z.Top,te=!!(E.focusable||y&&typeof E.focusable>"u"),Q=typeof r<"u"&&(E.updatable||x&&typeof E.updatable>"u");if(!F||!X)return M==null||M("008",he.error008(F,E)),null;const{sourceX:J,sourceY:U,targetX:re,targetY:ue}=ir(P,F,W,Y,X,j);return S.createElement(v,{key:E.id,id:E.id,className:ce([E.className,i]),type:T,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:J,sourceY:U,targetX:re,targetY:ue,sourcePosition:W,targetPosition:j,elementsSelectable:N,onEdgeUpdate:r,onContextMenu:c,onMouseEnter:l,onMouseMove:u,onMouseLeave:a,onClick:d,edgeUpdaterRadius:m,onEdgeDoubleClick:g,onEdgeUpdateStart:w,onEdgeUpdateEnd:f,rfId:o,ariaLabel:E.ariaLabel,isFocusable:te,isUpdatable:Q,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth})})))),p):null};to.displayName="EdgeRenderer";var xr=h.memo(to);const Sr=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Er({children:e}){const t=G(Sr);return S.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function wr(e){const t=Lt(),n=h.useRef(!1);h.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const br={[z.Left]:z.Right,[z.Right]:z.Left,[z.Top]:z.Bottom,[z.Bottom]:z.Top},no=({nodeId:e,handleType:t,style:n,type:o=we.Bezier,CustomComponent:s,connectionStatus:i})=>{var I,$,M;const{fromNode:r,handleId:c,toX:l,toY:u,connectionMode:a}=G(h.useCallback(A=>({fromNode:A.nodeInternals.get(e),handleId:A.connectionHandleId,toX:(A.connectionPosition.x-A.transform[0])/A.transform[2],toY:(A.connectionPosition.y-A.transform[1])/A.transform[2],connectionMode:A.connectionMode}),[e]),se),d=(I=r==null?void 0:r[q])==null?void 0:I.handleBounds;let m=d==null?void 0:d[t];if(a===Re.Loose&&(m=m||(d==null?void 0:d[t==="source"?"target":"source"])),!r||!m)return null;const g=c?m.find(A=>A.id===c):m[0],w=g?g.x+g.width/2:(r.width??0)/2,f=g?g.y+g.height/2:r.height??0,p=((($=r.positionAbsolute)==null?void 0:$.x)??0)+w,y=(((M=r.positionAbsolute)==null?void 0:M.y)??0)+f,x=g==null?void 0:g.position,N=x?br[x]:null;if(!x||!N)return null;if(s)return S.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:g,fromX:p,fromY:y,toX:l,toY:u,fromPosition:x,toPosition:N,connectionStatus:i});let C="";const D={sourceX:p,sourceY:y,sourcePosition:x,targetX:l,targetY:u,targetPosition:N};return o===we.Bezier?[C]=Mn(D):o===we.Step?[C]=Nt({...D,borderRadius:0}):o===we.SmoothStep?[C]=Nt(D):o===we.SimpleBezier?[C]=Cn(D):C=`M${p},${y} ${l},${u}`,S.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:n})};no.displayName="ConnectionLine";const Nr=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Cr({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:u}=G(Nr,se);return!(s&&i&&c&&r)?null:S.createElement("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},S.createElement("g",{className:ce(["react-flow__connection",u])},S.createElement(no,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function mn(e,t){return h.useRef(null),ne(),h.useMemo(()=>t(e),[e])}const oo=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:g,onSelectionContextMenu:w,onSelectionStart:f,onSelectionEnd:p,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:N,connectionLineContainerStyle:C,selectionKeyCode:D,selectionOnDrag:I,selectionMode:$,multiSelectionKeyCode:M,panActivationKeyCode:A,zoomActivationKeyCode:B,deleteKeyCode:_,onlyRenderVisibleElements:R,elementsSelectable:E,selectNodesOnDrag:P,defaultViewport:k,translateExtent:L,minZoom:Y,maxZoom:V,preventScrolling:b,defaultMarkerColor:T,zoomOnScroll:v,zoomOnPinch:H,panOnScroll:F,panOnScrollSpeed:X,panOnScrollMode:W,zoomOnDoubleClick:j,panOnDrag:te,onPaneClick:Q,onPaneMouseEnter:J,onPaneMouseMove:U,onPaneMouseLeave:re,onPaneScroll:ue,onPaneContextMenu:fe,onEdgeUpdate:ee,onEdgeContextMenu:ge,onEdgeMouseEnter:K,onEdgeMouseMove:ie,onEdgeMouseLeave:O,edgeUpdaterRadius:Ne,onEdgeUpdateStart:Ce,onEdgeUpdateEnd:We,noDragClassName:Te,noWheelClassName:Me,noPanClassName:ye,elevateEdgesOnSelect:Ie,disableKeyboardA11y:xe,nodeOrigin:Ae,nodeExtent:Ke,rfId:Be})=>{const oe=mn(e,Qs),ae=mn(t,rr);return wr(i),S.createElement(js,{onPaneClick:Q,onPaneMouseEnter:J,onPaneMouseMove:U,onPaneMouseLeave:re,onPaneContextMenu:fe,onPaneScroll:ue,deleteKeyCode:_,selectionKeyCode:D,selectionOnDrag:I,selectionMode:$,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:M,panActivationKeyCode:A,zoomActivationKeyCode:B,elementsSelectable:E,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:v,zoomOnPinch:H,zoomOnDoubleClick:j,panOnScroll:F,panOnScrollSpeed:X,panOnScrollMode:W,panOnDrag:te,defaultViewport:k,translateExtent:L,minZoom:Y,maxZoom:V,onSelectionContextMenu:w,preventScrolling:b,noDragClassName:Te,noWheelClassName:Me,noPanClassName:ye,disableKeyboardA11y:xe},S.createElement(Er,null,S.createElement(xr,{edgeTypes:ae,onEdgeClick:c,onEdgeDoubleClick:u,onEdgeUpdate:ee,onlyRenderVisibleElements:R,onEdgeContextMenu:ge,onEdgeMouseEnter:K,onEdgeMouseMove:ie,onEdgeMouseLeave:O,onEdgeUpdateStart:Ce,onEdgeUpdateEnd:We,edgeUpdaterRadius:Ne,defaultMarkerColor:T,noPanClassName:ye,elevateEdgesOnSelect:!!Ie,disableKeyboardA11y:xe,rfId:Be},S.createElement(Cr,{style:x,type:y,component:N,containerStyle:C})),S.createElement("div",{className:"react-flow__edgelabel-renderer"}),S.createElement(tr,{nodeTypes:oe,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:g,selectNodesOnDrag:P,onlyRenderVisibleElements:R,noPanClassName:ye,noDragClassName:Te,disableKeyboardA11y:xe,nodeOrigin:Ae,nodeExtent:Ke,rfId:Be})))};oo.displayName="GraphView";var Mr=h.memo(oo);const Pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Se={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Pt,nodeExtent:Pt,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Re.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Jo,isValidConnection:void 0},Ar=()=>Fo((e,t)=>({...Se,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:yt(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?yt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:u}=t(),a=l==null?void 0:l.querySelector(".react-flow__viewport");if(!a)return;const d=window.getComputedStyle(a),{m22:m}=new window.DOMMatrixReadOnly(d.transform),g=n.reduce((f,p)=>{const y=s.get(p.id);if(y){const x=$t(p.nodeElement);!!(x.width&&x.height&&(y.width!==x.width||y.height!==x.height||p.forceUpdate))&&(s.set(y.id,{...y,[q]:{...y[q],handleBounds:{source:cn(".source",p.nodeElement,m,u),target:cn(".target",p.nodeElement,m,u)}},...x}),f.push({id:y.id,type:"dimensions",dimensions:x}))}return f},[]);Yn(s,u);const w=r||i&&!r&&Xn(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:w}),(g==null?void 0:g.length)>0&&(o==null||o(g))},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const u=Wn(n,c()),a=yt(u,s,r,l);e({nodeInternals:a})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>Ee(l,!0)):(r=Oe(i(),n),c=Oe(s,[])),rt({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>Ee(l,!0)):(r=Oe(s,n),c=Oe(i(),[])),rt({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,Ee(a.id,!1))),u=c.map(a=>Ee(a.id,!1));rt({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var o;(o=t().d3Zoom)==null||o.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>Ee(c.id,!1)),r=n.filter(c=>c.selected).map(c=>Ee(c.id,!1));rt({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=kt(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const u=Fe.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],d=r==null?void 0:r.constrain()(u,a,l);return r.transform(c,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Se.connectionNodeId,connectionHandleId:Se.connectionHandleId,connectionHandleType:Se.connectionHandleType,connectionStatus:Se.connectionStatus,connectionStartHandle:Se.connectionStartHandle,connectionEndHandle:Se.connectionEndHandle}),reset:()=>e({...Se})}),Object.is),so=({children:e})=>{const t=h.useRef(null);return t.current||(t.current=Ar()),S.createElement(Zo,{value:t.current},e)};so.displayName="ReactFlowProvider";const ro=({children:e})=>h.useContext(dt)?S.createElement(S.Fragment,null,e):S.createElement(so,null,e);ro.displayName="ReactFlowWrapper";const vr={input:Bn,default:At,output:zn,group:zt},Pr={default:lt,straight:Tt,step:Rt,smoothstep:ft,simplebezier:_t},$r=[0,0],kr=[15,15],Dr={x:0,y:0,zoom:1},_r={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Rr=h.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=vr,edgeTypes:r=Pr,onNodeClick:c,onEdgeClick:l,onInit:u,onMove:a,onMoveStart:d,onMoveEnd:m,onConnect:g,onConnectStart:w,onConnectEnd:f,onClickConnectStart:p,onClickConnectEnd:y,onNodeMouseEnter:x,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:D,onNodeDoubleClick:I,onNodeDragStart:$,onNodeDrag:M,onNodeDragStop:A,onNodesDelete:B,onEdgesDelete:_,onSelectionChange:R,onSelectionDragStart:E,onSelectionDrag:P,onSelectionDragStop:k,onSelectionContextMenu:L,onSelectionStart:Y,onSelectionEnd:V,connectionMode:b=Re.Strict,connectionLineType:T=we.Bezier,connectionLineStyle:v,connectionLineComponent:H,connectionLineContainerStyle:F,deleteKeyCode:X="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:j=!1,selectionMode:te=et.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:J=ct()?"Meta":"Control",zoomActivationKeyCode:U=ct()?"Meta":"Control",snapToGrid:re=!1,snapGrid:ue=kr,onlyRenderVisibleElements:fe=!1,selectNodesOnDrag:ee=!0,nodesDraggable:ge,nodesConnectable:K,nodesFocusable:ie,nodeOrigin:O=$r,edgesFocusable:Ne,edgesUpdatable:Ce,elementsSelectable:We,defaultViewport:Te=Dr,minZoom:Me=.5,maxZoom:ye=2,translateExtent:Ie=Pt,preventScrolling:xe=!0,nodeExtent:Ae,defaultMarkerColor:Ke="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:oe=!0,panOnScroll:ae=!1,panOnScrollSpeed:ve=.5,panOnScrollMode:Pe=_e.Free,zoomOnDoubleClick:$e=!0,panOnDrag:pe=!0,onPaneClick:me,onPaneMouseEnter:Ue,onPaneMouseMove:gt,onPaneMouseLeave:Ge,onPaneScroll:mt,onPaneContextMenu:Ot,children:ke,onEdgeUpdate:lo,onEdgeContextMenu:uo,onEdgeDoubleClick:fo,onEdgeMouseEnter:go,onEdgeMouseMove:mo,onEdgeMouseLeave:po,onEdgeUpdateStart:ho,onEdgeUpdateEnd:yo,edgeUpdaterRadius:xo=10,onNodesChange:So,onEdgesChange:Eo,noDragClassName:wo="nodrag",noWheelClassName:bo="nowheel",noPanClassName:Ft="nopan",fitView:No=!1,fitViewOptions:Co,connectOnClick:Mo=!0,attributionPosition:Ao,proOptions:vo,defaultEdgeOptions:Po,elevateNodesOnSelect:$o=!0,elevateEdgesOnSelect:ko=!1,disableKeyboardA11y:Yt=!1,autoPanOnConnect:Do=!0,autoPanOnNodeDrag:_o=!0,connectionRadius:Ro=20,isValidConnection:To,onError:Io,style:Bo,id:Xt,nodeDragThreshold:Ho,...zo},Lo)=>{const pt=Xt||"1";return S.createElement("div",{...zo,style:{...Bo,..._r},ref:Lo,className:ce(["react-flow",s]),"data-testid":"rf__wrapper",id:Xt},S.createElement(ro,null,S.createElement(Mr,{onInit:u,onMove:a,onMoveStart:d,onMoveEnd:m,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:D,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:r,connectionLineType:T,connectionLineStyle:v,connectionLineComponent:H,connectionLineContainerStyle:F,selectionKeyCode:W,selectionOnDrag:j,selectionMode:te,deleteKeyCode:X,multiSelectionKeyCode:J,panActivationKeyCode:Q,zoomActivationKeyCode:U,onlyRenderVisibleElements:fe,selectNodesOnDrag:ee,defaultViewport:Te,translateExtent:Ie,minZoom:Me,maxZoom:ye,preventScrolling:xe,zoomOnScroll:Be,zoomOnPinch:oe,zoomOnDoubleClick:$e,panOnScroll:ae,panOnScrollSpeed:ve,panOnScrollMode:Pe,panOnDrag:pe,onPaneClick:me,onPaneMouseEnter:Ue,onPaneMouseMove:gt,onPaneMouseLeave:Ge,onPaneScroll:mt,onPaneContextMenu:Ot,onSelectionContextMenu:L,onSelectionStart:Y,onSelectionEnd:V,onEdgeUpdate:lo,onEdgeContextMenu:uo,onEdgeDoubleClick:fo,onEdgeMouseEnter:go,onEdgeMouseMove:mo,onEdgeMouseLeave:po,onEdgeUpdateStart:ho,onEdgeUpdateEnd:yo,edgeUpdaterRadius:xo,defaultMarkerColor:Ke,noDragClassName:wo,noWheelClassName:bo,noPanClassName:Ft,elevateEdgesOnSelect:ko,rfId:pt,disableKeyboardA11y:Yt,nodeOrigin:O,nodeExtent:Ae}),S.createElement(bs,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:w,onConnectEnd:f,onClickConnectStart:p,onClickConnectEnd:y,nodesDraggable:ge,nodesConnectable:K,nodesFocusable:ie,edgesFocusable:Ne,edgesUpdatable:Ce,elementsSelectable:We,elevateNodesOnSelect:$o,minZoom:Me,maxZoom:ye,nodeExtent:Ae,onNodesChange:So,onEdgesChange:Eo,snapToGrid:re,snapGrid:ue,connectionMode:b,translateExtent:Ie,connectOnClick:Mo,defaultEdgeOptions:Po,fitView:No,fitViewOptions:Co,onNodesDelete:B,onEdgesDelete:_,onNodeDragStart:$,onNodeDrag:M,onNodeDragStop:A,onSelectionDrag:P,onSelectionDragStart:E,onSelectionDragStop:k,noPanClassName:Ft,nodeOrigin:O,rfId:pt,autoPanOnConnect:Do,autoPanOnNodeDrag:_o,onError:Io,connectionRadius:Ro,isValidConnection:To,nodeDragThreshold:Ho}),S.createElement(Es,{onSelectionChange:R}),ke,S.createElement(Ko,{proOptions:vo,position:Ao}),S.createElement(vs,{rfId:pt,disableKeyboardA11y:Yt})))});Rr.displayName="ReactFlow";function io(e){return t=>{const[n,o]=h.useState(t),s=h.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Jr=io(Wn),ei=io(Os);function Tr(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},S.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ir(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},S.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Br(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},S.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Hr(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},S.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function zr(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},S.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Je=({children:e,className:t,...n})=>S.createElement("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n},e);Je.displayName="ControlButton";const Lr=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),co=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:r,onFitView:c,onInteractiveChange:l,className:u,children:a,position:d="bottom-left"})=>{const m=ne(),[g,w]=h.useState(!1),{isInteractive:f,minZoomReached:p,maxZoomReached:y}=G(Lr,se),{zoomIn:x,zoomOut:N,fitView:C}=Lt();if(h.useEffect(()=>{w(!0)},[]),!g)return null;const D=()=>{x(),i==null||i()},I=()=>{N(),r==null||r()},$=()=>{C(s),c==null||c()},M=()=>{m.setState({nodesDraggable:!f,nodesConnectable:!f,elementsSelectable:!f}),l==null||l(!f)};return S.createElement(yn,{className:ce(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&S.createElement(S.Fragment,null,S.createElement(Je,{onClick:D,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},S.createElement(Tr,null)),S.createElement(Je,{onClick:I,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:p},S.createElement(Ir,null))),n&&S.createElement(Je,{className:"react-flow__controls-fitview",onClick:$,title:"fit view","aria-label":"fit view"},S.createElement(Br,null)),o&&S.createElement(Je,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity"},f?S.createElement(zr,null):S.createElement(Hr,null)),a)};co.displayName="Controls";var ti=h.memo(co),de;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(de||(de={}));function Vr({color:e,dimensions:t,lineWidth:n}){return S.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Or({color:e,radius:t}){return S.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Fr={[de.Dots]:"#91919a",[de.Lines]:"#eee",[de.Cross]:"#e2e2e2"},Yr={[de.Dots]:1,[de.Lines]:1,[de.Cross]:6},Xr=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ao({id:e,variant:t=de.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:c,className:l}){const u=h.useRef(null),{transform:a,patternId:d}=G(Xr,se),m=r||Fr[t],g=o||Yr[t],w=t===de.Dots,f=t===de.Cross,p=Array.isArray(n)?n:[n,n],y=[p[0]*a[2]||1,p[1]*a[2]||1],x=g*a[2],N=f?[x,x]:y,C=w?[x/i,x/i]:[N[0]/i,N[1]/i];return S.createElement("svg",{className:ce(["react-flow__background",l]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},S.createElement("pattern",{id:d+e,x:a[0]%y[0],y:a[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},w?S.createElement(Or,{color:m,radius:x/i}):S.createElement(Vr,{dimensions:N,color:m,lineWidth:s})),S.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}ao.displayName="Background";var ni=h.memo(ao);export{ni as B,ti as C,so as R,ei as a,Rr as b,us as c,Jr as u};
